window.glaze={};
(function(){function j(a,c,b){function d(a){g=g||a;typeof b==="function"?b(g):console.error(g)}var e=new XMLHttpRequest,g;e.addEventListener("load",function(){c(e.responseText)},!1);e.addEventListener("error",d,!1);e.addEventListener("abort",d,!1);try{e.open("GET",window.encodeURI(a),!0),e.send(null)}catch(f){g=f}}function h(a){if(a instanceof window.HTMLElement)return a;typeof a==="string"&&(a=a[0]==="#"?a.slice(1):a);return document.getElementById(a)}function k(a,c){var b=h(a),b=b?b.innerHTML:null;
typeof c==="function"&&c(b);return b}function i(a,c){var b=Array.prototype.slice.call(arguments,2),d=window.gl;b.length===0&&(b=null);window.gl=a;b=c.apply(this,b);window.gl=d;return b}window.gl=null;Object.defineProperty(glaze,"element",function(){var a=null;return{enumerable:!0,configurable:!0,get:function(){return a},set:function(c){if(c===null)return window.gl=a=null;a=c=h(c);window.gl=a.getContext("experimental-webgl")}}}());(function(){function a(){for(var a=0,c=b.length;a<c;a++)b[a].call(glaze.element,
window.gl);b.length=0}function c(){a();window.removeEventListener("DOMContentLoaded",c,!1)}var b=[];glaze.ready=function(c){var e,g;arguments.length===2&&(e=h(arguments[0]),c=arguments[1]);e?b.push(function(){g=glaze.element;glaze.element=e;c.call(e,window.gl);glaze.element=g}):b.push(c);window.readyState==="complete"&&a()};window.readyState!=="complete"&&(window.addEventListener?window.addEventListener("DOMContentLoaded",c,!1):console.error("window.addEventListener not supported."))})();if(typeof window.requestAnimationFrame!==
"function")window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};glaze.animate=function(a){var c=Array.prototype.slice.call(arguments,1),b=c[0]instanceof HTMLElement?c.shift():glaze.element,d=c[0]instanceof WebGLRenderingContext?c.shift():window.gl,e=this;c.length===0&&(c=null);(function f(){if(!window.gl)window.gl=d;a.apply(e,c);window.requestAnimationFrame(f,
b)})()};glaze.createShader=function(a,c){var b,d=arguments.length===3?arguments[2]:window.gl;if(a==="vertex")a=d.VERTEX_SHADER;if(a==="fragment")a=d.FRAGMENT_SHADER;b=d.createShader(a);d.shaderSource(b,c);d.compileShader(b);return b};glaze.loadShader=function(a,c){var b=Array.prototype.slice.call(arguments),d=typeof b[b.length-1]==="function"?b.pop():null,e=b[b.length-1]instanceof WebGLRenderingContext?b.pop():window.gl;if(b=h(a))return b=glaze.createShader(c,k(b),e),typeof d==="function"&&i(e,d,
b),b;else j(a,function(a){i(e,d,glaze.createShader(c,a,e))})};glaze.createProgram=function(a,c){var b,d=arguments.length===3?arguments[2]:window.gl;b=d.createProgram();d.attachShader(b,a);d.attachShader(b,c);d.linkProgram(b);return b};glaze.loadProgram=function(a){var c,b,d,e;c=Array.prototype.slice.call(arguments);var g=typeof c[c.length-1]==="function"?c.pop():null,f=c[c.length-1]instanceof WebGLRenderingContext?c.pop():window.gl;c=h(a.vertex);b=h(a.fragment);c&&(d=glaze.loadShader(c,f.VERTEX_SHADER,
f));b&&(e=glaze.loadShader(b,f.FRAGMENT_SHADER,f));if(d&&e)return c=glaze.createProgram(d,e,f),typeof g==="function"&&i(f,g,c),c;d||glaze.loadShader(a.vertex,f.VERTEX_SHADER,function(a){e?i(f,g,glaze.createProgram(a,e,f)):d=a});e||glaze.loadShader(a.fragment,f.FRAGMENT_SHADER,f,function(a){d?i(f,g,glaze.createProgram(d,a,f)):e=a})};glaze.createAttribute=function(a,c){var b,d=arguments.length===3?arguments[2]:window.gl;d.useProgram(a);b=d.getAttribLocation(a,c);d.enableVertexAttribArray(b);return b};
glaze.createUniform=function(a,c){var b=arguments.length===3?arguments[2]:window.gl;b.useProgram(a);return b.getUniformLocation(a,c)};glaze.createBuffer=function(a,c,b){var d,c=c===void 0?gl.ARRAY_BUFFER:c,b=b===void 0?gl.STATIC_DRAW:b;d=gl.createBuffer();gl.bindBuffer(c,d);c===gl.ARRAY_BUFFER?(Array.isArray(a)&&(a=new window.Float32Array(a)),gl.bufferData(gl.ARRAY_BUFFER,a,b)):(Array.isArray(a)&&(a=new window.Uint16Array(a)),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,a,b));return d};glaze.createTexture=
function(a,c){var c=c===void 0?gl.RGBA:c,b=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,b);gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!0);gl.texImage2D(gl.TEXTURE_2D,0,c,c,gl.UNSIGNED_BYTE,a);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);gl.generateMipmap(gl.TEXTURE_2D);gl.bindTexture(gl.TEXTURE_2D,null);return b};glaze.loadTexture=function(a,c){function b(){throw new URIError("glaze.loadTexture: Unable to load "+d.src);
}var d;typeof a!=="string"?d=a:a[0]==="#"?(a=a[0]==="#"?a.slice(1):a,d=document.getElementById(a)):(d=new window.Image,d.src=window.encodeURI(a));if(!d instanceof window.Image)throw new ReferenceError("glaze.loadTexture: Image must be an element or url.");d.complete?c(glaze.createTexture(d)):(d.addEventListener("load",function(){c(glaze.createTexture(d))}),d.addEventListener("error",b),d.addEventListener("abort",b))}})();
